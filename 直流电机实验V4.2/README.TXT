

滑到最下面查看最新注解

/***************************************************


         硬件连接： 开发板  A6-PWM4 A7-PWM3 GND-GND
			               电机	 红-OUT1  黑-OUT2
										 编码器 :B6-B   B7-A
                      串口1接PC
											ADC-ADC
											编码器与ACS712均5V供电
																			
                                       2018/10/05
																			          方
******************************************************/

/*****************************************************

  包含了串口通信，CAN通信功能
	
	有AD采样，速度位置环，位置环需要重写


                                  2018/10/13

                                            方
***************************************************/
/*****************************************************

  位置环已重置
	AD采样去掉了每次采样之后的延时
	应该将ADC放到中断 +DMA
	电流环已增加
	
	三个环的参数或许都要重做
	
	CAN通信尚未对程序主体进行操作
	
	                    2018/10/21
								         			方




*************************************************/
/*************************************************



        CAN通信搭了个架子
				CAN改为了中断触发
				另增了几个控制模式
				
				具体协议看程序注释
				
				    2018/10/25
						 方・




*********************************************/

/*********************************************

       去掉了CAN加入了USB虚拟串口
			 ――方
			 2018/10/28


******************************************/

/***************************************

   这是RCT6与ZET6的工程 经测试可用
	 修复了自3.0开始的BUG
	 
	 位置环暂时是废了~~~
	 暂时只有 模式1 2 4 正常工作
	               ――方
								 2018/10/29




*********************************/
/*******************************


更换成自制的点电机驱动板
硬件连接：
 A7-DC1
 A6-DC2
 
 红-M1
 黑-M2
 
 ADC(板载)-ADC1
 
 编码器 A- B6
        B- B7
				VCC-5V
				GND-GND
				
 GND-GND






***************************/

/***************************

硬件连接：
如按上述连接有误
   就把电机线正负极调整一下
	 
修改了一个正交解码的BUG
 原先溢出后Count直接置10000
 后续计算时可能会出现Old_count=19995, count=10001这种情况
 改为减去10000
   //定时器4中断服务程序
void TIM4_IRQHandler(void)   //TIM4中断
{
	if (TIM_GetITStatus(TIM4, TIM_IT_Update) != RESET)  //检查TIM4更新中断发生与否
		{
		TIM_ClearITPendingBit(TIM4, TIM_IT_Update  );  //清除TIMx更新中断标志 
		
		 TIM4->CNT = 10000;
			//Count=10000;  
			Count-=10000;
			
		}
		
}

       2019/1/25
			       方

****************************/
/**************************************


位置速度环已验证可行，但调整时间过长，需要尽量减少震荡

电流环似乎有bug，待调整。
				
				
				2019/2/25
				      方






***********************************/
/***************************************


  电流环加入了堵转保护
       在main.c的while()里
	   
	        2019/2/27
			     方



*****************************************/